{#
/**
 * @file
 * Custom theme implementation to display a Collection node.
 *
 * @ingroup themeable
 */
#}
{%
  set classes = [
    'node',
    node.bundle|clean_class,
    view_mode ? view_mode|clean_class,
  ]
%}

<div class="collection-wrapper {{count_talks_in_collection > 0 ? 'collection-has-children'}}">
  <article{{ attributes.addClass(classes) }}>
    {% if view_mode == 'teaser' and content.field_collection_description.0['#text']|length > 200 %}
      {% set show_show_more = TRUE %}
      {% set content_classes = ['collapse-abstract'] %}
    {% endif %}
    {% block thumbnail %}
      {{ content.field_talk_thumbnail }}
    {% endblock %}
    <div{{ content_attributes.addClass(content_classes,'content node-content') }}>
      {{ content.field_parent_collection }}
      {% embed "@scitalk_theme/includes/entity-headers.twig" %}{% endembed %}
      <div class="info">

        {% if count_talks_in_collection %}
           <strong>{{ count_talks_in_collection }}
            {{ count_talks_in_collection == 1 ? 'Talk'|t : 'Talks'|t }}
          </strong>
        {% endif %}
        {% if count_talks_in_collection and count_child_collections %}
          {{ 'and '}}
        {% endif %}
        {% if count_child_collections %}
           {{ count_child_collections }}
           {{ count_child_collections == 1 ? 'sub-collection'|t : 'sub-collections'|t }}
        {% endif %}

        {{ content|without('links','field_collection_description') }}
      </div>
      {% if view_mode == 'teaser' %}
        {{ content.field_collection_description }}
        {% if show_show_more == TRUE %}
          <button class="show-more show" aria-hidden="hidden" data-hide-text="{{'Hide'}}" data-show-text="{{'Show more'}}">{{'Show more'|t}}</button>
        {% endif %}
      {% endif %}

        <button class="show-children" data-node-id="{{ node.id }}">
          <span class="visually-hidden">{{ 'Load child talks and sub-collections'|t }}
        </button>
    </div>
  </article>
</div>

<button class="hide-children">
  <span class="visually-hidden">{{ 'Hide child talks and collections'|t }}</span>
</button>

{% if (count_talks_in_collection > 1) or (count_child_collections > 1) %}
  <div class="js-view-dom-id-collection-children-{{node.id}} collection-children"></div>
{% endif %}
